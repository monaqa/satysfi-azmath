@require: base/list-ext

module AZMathUnicode : sig

  val enable-unicode-math : context -> context
  
  direct \unicode-math: [math] inline-cmd
  direct +enable-unicode-math: [block-text] block-cmd
  direct \enable-unicode-math: [inline-text] inline-cmd

end = struct

  let greek-chars = [
    (|origin = 0x03B1; normal = 0x1D6FC; bold = 0x1D736|);  % Î± -> ð›¼, ðœ¶
    (|origin = 0x03B2; normal = 0x1D6FD; bold = 0x1D737|);  % Î² -> ð›½, ðœ·
    (|origin = 0x03B3; normal = 0x1D6FE; bold = 0x1D738|);  % Î³ -> ð›¾, ðœ¸
    (|origin = 0x03B4; normal = 0x1D6FF; bold = 0x1D739|);  % Î´ -> ð›¿, ðœ¹
    (|origin = 0x03B5; normal = 0x1D700; bold = 0x1D73A|);  % Îµ -> ðœ€, ðœº
    (|origin = 0x03B6; normal = 0x1D701; bold = 0x1D73B|);  % Î¶ -> ðœ, ðœ»
    (|origin = 0x03B7; normal = 0x1D702; bold = 0x1D73C|);  % Î· -> ðœ‚, ðœ¼
    (|origin = 0x03B8; normal = 0x1D703; bold = 0x1D73D|);  % Î¸ -> ðœƒ, ðœ½
    (|origin = 0x03B9; normal = 0x1D704; bold = 0x1D73E|);  % Î¹ -> ðœ„, ðœ¾
    (|origin = 0x03BA; normal = 0x1D705; bold = 0x1D73F|);  % Îº -> ðœ…, ðœ¿
    (|origin = 0x03BB; normal = 0x1D706; bold = 0x1D740|);  % Î» -> ðœ†, ð€
    (|origin = 0x03BC; normal = 0x1D707; bold = 0x1D741|);  % Î¼ -> ðœ‡, ð
    (|origin = 0x03BD; normal = 0x1D708; bold = 0x1D742|);  % Î½ -> ðœˆ, ð‚
    (|origin = 0x03BE; normal = 0x1D709; bold = 0x1D743|);  % Î¾ -> ðœ‰, ðƒ
    (|origin = 0x03BF; normal = 0x1D70A; bold = 0x1D744|);  % Î¿ -> ðœŠ, ð„
    (|origin = 0x03C0; normal = 0x1D70B; bold = 0x1D745|);  % Ï€ -> ðœ‹, ð…
    (|origin = 0x03C1; normal = 0x1D70C; bold = 0x1D746|);  % Ï -> ðœŒ, ð†
    (|origin = 0x03C2; normal = 0x1D70D; bold = 0x1D747|);  % Ï‚ -> ðœ, ð‡
    (|origin = 0x03C3; normal = 0x1D70E; bold = 0x1D748|);  % Ïƒ -> ðœŽ, ðˆ
    (|origin = 0x03C4; normal = 0x1D70F; bold = 0x1D749|);  % Ï„ -> ðœ, ð‰
    (|origin = 0x03C5; normal = 0x1D710; bold = 0x1D74A|);  % Ï… -> ðœ, ðŠ
    (|origin = 0x03C6; normal = 0x1D711; bold = 0x1D74B|);  % Ï† -> ðœ‘, ð‹
    (|origin = 0x03C7; normal = 0x1D712; bold = 0x1D74C|);  % Ï‡ -> ðœ’, ðŒ
    (|origin = 0x03C8; normal = 0x1D713; bold = 0x1D74D|);  % Ïˆ -> ðœ“, ð
    (|origin = 0x03C9; normal = 0x1D714; bold = 0x1D74E|);  % Ï‰ -> ðœ”, ðŽ
  ]

  let unicode-math-chars = [
    (|class = MathBin   ; codepoint = 0x00B1|);  % Â±
    (|class = MathPrefix; codepoint = 0x00B5|);  % Âµ
    (|class = MathBin   ; codepoint = 0x00D7|);  % Ã—
    (|class = MathBin   ; codepoint = 0x00F7|);  % Ã·

    % æ‹¬å¼§é¡ž
    (|class = MathOpen  ; codepoint = 0x0028|);  % (
    (|class = MathClose ; codepoint = 0x0029|);  % )
    (|class = MathOpen  ; codepoint = 0x005B|);  % [
    (|class = MathClose ; codepoint = 0x005D|);  % ]
    (|class = MathOpen  ; codepoint = 0x2308|);  % âŒˆ
    (|class = MathClose ; codepoint = 0x2309|);  % âŒ‰
    (|class = MathOpen  ; codepoint = 0x230A|);  % âŒŠ
    (|class = MathClose ; codepoint = 0x230B|);  % âŒ‹
    (|class = MathOpen  ; codepoint = 0x27E6|);  % âŸ¦
    (|class = MathClose ; codepoint = 0x27E7|);  % âŸ§
    (|class = MathOpen  ; codepoint = 0x27E8|);  % âŸ¨
    (|class = MathClose ; codepoint = 0x27E9|);  % âŸ©
    (|class = MathOpen  ; codepoint = 0x27EA|);  % âŸª
    (|class = MathClose ; codepoint = 0x27EB|);  % âŸ«
    (|class = MathOpen  ; codepoint = 0x27EC|);  % âŸ¬
    (|class = MathClose ; codepoint = 0x27ED|);  % âŸ­
    (|class = MathOpen  ; codepoint = 0x27EE|);  % âŸ®
    (|class = MathClose ; codepoint = 0x27EF|);  % âŸ¯

    % çŸ¢å°
    (|class = MathRel   ; codepoint = 0x2190|);  % â†
    (|class = MathRel   ; codepoint = 0x2191|);  % â†‘
    (|class = MathRel   ; codepoint = 0x2192|);  % â†’
    (|class = MathRel   ; codepoint = 0x2193|);  % â†“
    (|class = MathRel   ; codepoint = 0x2194|);  % â†”
    (|class = MathRel   ; codepoint = 0x2195|);  % â†•
    (|class = MathRel   ; codepoint = 0x2196|);  % â†–
    (|class = MathRel   ; codepoint = 0x2197|);  % â†—
    (|class = MathRel   ; codepoint = 0x2198|);  % â†˜
    (|class = MathRel   ; codepoint = 0x2199|);  % â†™
    (|class = MathRel   ; codepoint = 0x219A|);  % â†š
    (|class = MathRel   ; codepoint = 0x219B|);  % â†›
    (|class = MathRel   ; codepoint = 0x219C|);  % â†œ
    (|class = MathRel   ; codepoint = 0x219D|);  % â†
    (|class = MathRel   ; codepoint = 0x219E|);  % â†ž
    (|class = MathRel   ; codepoint = 0x219F|);  % â†Ÿ
    (|class = MathRel   ; codepoint = 0x21A0|);  % â† 
    (|class = MathRel   ; codepoint = 0x21A1|);  % â†¡
    (|class = MathRel   ; codepoint = 0x21A2|);  % â†¢
    (|class = MathRel   ; codepoint = 0x21A3|);  % â†£
    (|class = MathRel   ; codepoint = 0x21A4|);  % â†¤
    (|class = MathRel   ; codepoint = 0x21A5|);  % â†¥
    (|class = MathRel   ; codepoint = 0x21A6|);  % â†¦
    (|class = MathRel   ; codepoint = 0x21A7|);  % â†§
    (|class = MathRel   ; codepoint = 0x21A8|);  % â†¨
    (|class = MathRel   ; codepoint = 0x21A9|);  % â†©
    (|class = MathRel   ; codepoint = 0x21AA|);  % â†ª
    (|class = MathRel   ; codepoint = 0x21AB|);  % â†«
    (|class = MathRel   ; codepoint = 0x21AC|);  % â†¬
    (|class = MathRel   ; codepoint = 0x21AD|);  % â†­
    (|class = MathRel   ; codepoint = 0x21AE|);  % â†®
    (|class = MathRel   ; codepoint = 0x21AF|);  % â†¯
    (|class = MathRel   ; codepoint = 0x21B0|);  % â†°
    (|class = MathRel   ; codepoint = 0x21B1|);  % â†±
    (|class = MathRel   ; codepoint = 0x21B2|);  % â†²
    (|class = MathRel   ; codepoint = 0x21B3|);  % â†³
    (|class = MathRel   ; codepoint = 0x21B4|);  % â†´
    (|class = MathRel   ; codepoint = 0x21B5|);  % â†µ
    (|class = MathRel   ; codepoint = 0x21B6|);  % â†¶
    (|class = MathRel   ; codepoint = 0x21B7|);  % â†·
    (|class = MathRel   ; codepoint = 0x21B8|);  % â†¸
    (|class = MathRel   ; codepoint = 0x21B9|);  % â†¹
    (|class = MathRel   ; codepoint = 0x21BA|);  % â†º
    (|class = MathRel   ; codepoint = 0x21BB|);  % â†»
    (|class = MathRel   ; codepoint = 0x21BC|);  % â†¼
    (|class = MathRel   ; codepoint = 0x21BD|);  % â†½
    (|class = MathRel   ; codepoint = 0x21BE|);  % â†¾
    (|class = MathRel   ; codepoint = 0x21BF|);  % â†¿
    (|class = MathRel   ; codepoint = 0x21C0|);  % â‡€
    (|class = MathRel   ; codepoint = 0x21C1|);  % â‡
    (|class = MathRel   ; codepoint = 0x21C2|);  % â‡‚
    (|class = MathRel   ; codepoint = 0x21C3|);  % â‡ƒ
    (|class = MathRel   ; codepoint = 0x21C4|);  % â‡„
    (|class = MathRel   ; codepoint = 0x21C5|);  % â‡…
    (|class = MathRel   ; codepoint = 0x21C6|);  % â‡†
    (|class = MathRel   ; codepoint = 0x21C7|);  % â‡‡
    (|class = MathRel   ; codepoint = 0x21C8|);  % â‡ˆ
    (|class = MathRel   ; codepoint = 0x21C9|);  % â‡‰
    (|class = MathRel   ; codepoint = 0x21CA|);  % â‡Š
    (|class = MathRel   ; codepoint = 0x21CB|);  % â‡‹
    (|class = MathRel   ; codepoint = 0x21CC|);  % â‡Œ
    (|class = MathRel   ; codepoint = 0x21CD|);  % â‡
    (|class = MathRel   ; codepoint = 0x21CE|);  % â‡Ž
    (|class = MathRel   ; codepoint = 0x21CF|);  % â‡
    (|class = MathRel   ; codepoint = 0x21D0|);  % â‡
    (|class = MathRel   ; codepoint = 0x21D1|);  % â‡‘
    (|class = MathRel   ; codepoint = 0x21D2|);  % â‡’
    (|class = MathRel   ; codepoint = 0x21D3|);  % â‡“
    (|class = MathRel   ; codepoint = 0x21D4|);  % â‡”
    (|class = MathRel   ; codepoint = 0x21D5|);  % â‡•
    (|class = MathRel   ; codepoint = 0x21D6|);  % â‡–
    (|class = MathRel   ; codepoint = 0x21D7|);  % â‡—
    (|class = MathRel   ; codepoint = 0x21D8|);  % â‡˜
    (|class = MathRel   ; codepoint = 0x21D9|);  % â‡™
    (|class = MathRel   ; codepoint = 0x21DA|);  % â‡š
    (|class = MathRel   ; codepoint = 0x21DB|);  % â‡›
    (|class = MathRel   ; codepoint = 0x21DC|);  % â‡œ
    (|class = MathRel   ; codepoint = 0x21DD|);  % â‡
    (|class = MathRel   ; codepoint = 0x21DE|);  % â‡ž
    (|class = MathRel   ; codepoint = 0x21DF|);  % â‡Ÿ
    (|class = MathRel   ; codepoint = 0x21E0|);  % â‡ 
    (|class = MathRel   ; codepoint = 0x21E1|);  % â‡¡
    (|class = MathRel   ; codepoint = 0x21E2|);  % â‡¢
    (|class = MathRel   ; codepoint = 0x21E3|);  % â‡£
    (|class = MathRel   ; codepoint = 0x21E4|);  % â‡¤
    (|class = MathRel   ; codepoint = 0x21E5|);  % â‡¥
    (|class = MathRel   ; codepoint = 0x21E6|);  % â‡¦
    (|class = MathRel   ; codepoint = 0x21E7|);  % â‡§
    (|class = MathRel   ; codepoint = 0x21E8|);  % â‡¨
    (|class = MathRel   ; codepoint = 0x21E9|);  % â‡©
    (|class = MathRel   ; codepoint = 0x21EA|);  % â‡ª
    (|class = MathRel   ; codepoint = 0x21EB|);  % â‡«
    (|class = MathRel   ; codepoint = 0x21EC|);  % â‡¬
    (|class = MathRel   ; codepoint = 0x21ED|);  % â‡­
    (|class = MathRel   ; codepoint = 0x21EE|);  % â‡®
    (|class = MathRel   ; codepoint = 0x21EF|);  % â‡¯
    (|class = MathRel   ; codepoint = 0x21F0|);  % â‡°
    (|class = MathRel   ; codepoint = 0x21F1|);  % â‡±
    (|class = MathRel   ; codepoint = 0x21F2|);  % â‡²
    (|class = MathRel   ; codepoint = 0x21F3|);  % â‡³
    (|class = MathRel   ; codepoint = 0x21F4|);  % â‡´
    (|class = MathRel   ; codepoint = 0x21F5|);  % â‡µ
    (|class = MathRel   ; codepoint = 0x21F6|);  % â‡¶
    (|class = MathRel   ; codepoint = 0x21F7|);  % â‡·
    (|class = MathRel   ; codepoint = 0x21F8|);  % â‡¸
    (|class = MathRel   ; codepoint = 0x21F9|);  % â‡¹
    (|class = MathRel   ; codepoint = 0x21FA|);  % â‡º
    (|class = MathRel   ; codepoint = 0x21FB|);  % â‡»
    (|class = MathRel   ; codepoint = 0x21FC|);  % â‡¼
    (|class = MathRel   ; codepoint = 0x21FD|);  % â‡½
    (|class = MathRel   ; codepoint = 0x21FE|);  % â‡¾
    (|class = MathRel   ; codepoint = 0x21FF|);  % â‡¿
    (|class = MathRel   ; codepoint = 0x27F0|);  % âŸ°
    (|class = MathRel   ; codepoint = 0x27F1|);  % âŸ±
    (|class = MathRel   ; codepoint = 0x27F2|);  % âŸ²
    (|class = MathRel   ; codepoint = 0x27F3|);  % âŸ³
    (|class = MathRel   ; codepoint = 0x27F4|);  % âŸ´
    (|class = MathRel   ; codepoint = 0x27F5|);  % âŸµ
    (|class = MathRel   ; codepoint = 0x27F6|);  % âŸ¶
    (|class = MathRel   ; codepoint = 0x27F7|);  % âŸ·
    (|class = MathRel   ; codepoint = 0x27F8|);  % âŸ¸
    (|class = MathRel   ; codepoint = 0x27F9|);  % âŸ¹
    (|class = MathRel   ; codepoint = 0x27FA|);  % âŸº
    (|class = MathRel   ; codepoint = 0x27FB|);  % âŸ»
    (|class = MathRel   ; codepoint = 0x27FC|);  % âŸ¼
    (|class = MathRel   ; codepoint = 0x27FD|);  % âŸ½
    (|class = MathRel   ; codepoint = 0x27FE|);  % âŸ¾
    (|class = MathRel   ; codepoint = 0x27FF|);  % âŸ¿

    % æ•°å­¦è¨˜å·
    (|class = MathPrefix; codepoint = 0x2200|);  % âˆ€
    (|class = MathPrefix; codepoint = 0x2202|);  % âˆ‚
    (|class = MathPrefix; codepoint = 0x2203|);  % âˆƒ
    (|class = MathPrefix; codepoint = 0x2204|);  % âˆ„
    (|class = MathOrd   ; codepoint = 0x2205|);  % âˆ…
    (|class = MathPrefix; codepoint = 0x2206|);  % âˆ†
    (|class = MathPrefix; codepoint = 0x2207|);  % âˆ‡
    (|class = MathRel   ; codepoint = 0x2208|);  % âˆˆ
    (|class = MathRel   ; codepoint = 0x2209|);  % âˆ‰
    (|class = MathRel   ; codepoint = 0x220A|);  % âˆŠ
    (|class = MathRel   ; codepoint = 0x220B|);  % âˆ‹
    (|class = MathRel   ; codepoint = 0x220C|);  % âˆŒ
    (|class = MathRel   ; codepoint = 0x220D|);  % âˆ
    (|class = MathOrd   ; codepoint = 0x220E|);  % âˆŽ
    (|class = MathOp    ; codepoint = 0x220F|);  % âˆ
    (|class = MathOp    ; codepoint = 0x2210|);  % âˆ
    (|class = MathOp    ; codepoint = 0x2211|);  % âˆ‘
    (|class = MathOrd   ; codepoint = 0x2212|);  % âˆ’
    (|class = MathBin   ; codepoint = 0x2213|);  % âˆ“
    (|class = MathBin   ; codepoint = 0x2214|);  % âˆ”
    (|class = MathBin   ; codepoint = 0x2215|);  % âˆ•
    (|class = MathBin   ; codepoint = 0x2216|);  % âˆ–
    (|class = MathBin   ; codepoint = 0x2217|);  % âˆ—
    (|class = MathBin   ; codepoint = 0x2218|);  % âˆ˜
    (|class = MathBin   ; codepoint = 0x2219|);  % âˆ™
    (|class = MathRel   ; codepoint = 0x221D|);  % âˆ
    (|class = MathOrd   ; codepoint = 0x221E|);  % âˆž
    (|class = MathPrefix; codepoint = 0x221F|);  % âˆŸ
    (|class = MathPrefix; codepoint = 0x2220|);  % âˆ 
    (|class = MathPrefix; codepoint = 0x2221|);  % âˆ¡
    (|class = MathPrefix; codepoint = 0x2222|);  % âˆ¢
    (|class = MathRel   ; codepoint = 0x2223|);  % âˆ£
    (|class = MathRel   ; codepoint = 0x2224|);  % âˆ¤
    (|class = MathRel   ; codepoint = 0x2225|);  % âˆ¥
    (|class = MathRel   ; codepoint = 0x2226|);  % âˆ¦
    (|class = MathBin   ; codepoint = 0x2227|);  % âˆ§
    (|class = MathBin   ; codepoint = 0x2228|);  % âˆ¨
    (|class = MathBin   ; codepoint = 0x2229|);  % âˆ©
    (|class = MathBin   ; codepoint = 0x222A|);  % âˆª
    (|class = MathOp    ; codepoint = 0x222B|);  % âˆ«
    (|class = MathOp    ; codepoint = 0x222C|);  % âˆ¬
    (|class = MathOp    ; codepoint = 0x222D|);  % âˆ­
    (|class = MathOp    ; codepoint = 0x222E|);  % âˆ®
    (|class = MathOp    ; codepoint = 0x222F|);  % âˆ¯
    (|class = MathOp    ; codepoint = 0x2230|);  % âˆ°
    (|class = MathOp    ; codepoint = 0x2231|);  % âˆ±
    (|class = MathOp    ; codepoint = 0x2232|);  % âˆ²
    (|class = MathOp    ; codepoint = 0x2233|);  % âˆ³
    (|class = MathOrd   ; codepoint = 0x2234|);  % âˆ´
    (|class = MathOrd   ; codepoint = 0x2235|);  % âˆµ
    (|class = MathBin   ; codepoint = 0x2236|);  % âˆ¶
    (|class = MathBin   ; codepoint = 0x2237|);  % âˆ·
    (|class = MathBin   ; codepoint = 0x2238|);  % âˆ¸
    (|class = MathBin   ; codepoint = 0x223B|);  % âˆ»
    (|class = MathRel   ; codepoint = 0x223C|);  % âˆ¼
    (|class = MathRel   ; codepoint = 0x223D|);  % âˆ½
    (|class = MathRel   ; codepoint = 0x223E|);  % âˆ¾
    (|class = MathOrd   ; codepoint = 0x223F|);  % âˆ¿
    (|class = MathOrd   ; codepoint = 0x2240|);  % â‰€
    (|class = MathRel   ; codepoint = 0x2241|);  % â‰
    (|class = MathRel   ; codepoint = 0x2242|);  % â‰‚
    (|class = MathRel   ; codepoint = 0x2243|);  % â‰ƒ
    (|class = MathRel   ; codepoint = 0x2244|);  % â‰„
    (|class = MathRel   ; codepoint = 0x2245|);  % â‰…
    (|class = MathRel   ; codepoint = 0x2246|);  % â‰†
    (|class = MathRel   ; codepoint = 0x2247|);  % â‰‡
    (|class = MathRel   ; codepoint = 0x2248|);  % â‰ˆ
    (|class = MathRel   ; codepoint = 0x2249|);  % â‰‰
    (|class = MathRel   ; codepoint = 0x224A|);  % â‰Š
    (|class = MathRel   ; codepoint = 0x224B|);  % â‰‹
    (|class = MathRel   ; codepoint = 0x224C|);  % â‰Œ
    (|class = MathRel   ; codepoint = 0x224D|);  % â‰
    (|class = MathRel   ; codepoint = 0x224E|);  % â‰Ž
    (|class = MathRel   ; codepoint = 0x224F|);  % â‰
    (|class = MathRel   ; codepoint = 0x2250|);  % â‰
    (|class = MathRel   ; codepoint = 0x2251|);  % â‰‘
    (|class = MathRel   ; codepoint = 0x2252|);  % â‰’
    (|class = MathRel   ; codepoint = 0x2253|);  % â‰“
    (|class = MathRel   ; codepoint = 0x2254|);  % â‰”
    (|class = MathRel   ; codepoint = 0x2255|);  % â‰•
    (|class = MathRel   ; codepoint = 0x2256|);  % â‰–
    (|class = MathRel   ; codepoint = 0x2257|);  % â‰—
    (|class = MathRel   ; codepoint = 0x2258|);  % â‰˜
    (|class = MathRel   ; codepoint = 0x2259|);  % â‰™
    (|class = MathRel   ; codepoint = 0x225A|);  % â‰š
    (|class = MathRel   ; codepoint = 0x225B|);  % â‰›
    (|class = MathRel   ; codepoint = 0x225C|);  % â‰œ
    (|class = MathRel   ; codepoint = 0x225D|);  % â‰
    (|class = MathRel   ; codepoint = 0x225E|);  % â‰ž
    (|class = MathRel   ; codepoint = 0x225F|);  % â‰Ÿ
    (|class = MathRel   ; codepoint = 0x2260|);  % â‰ 
    (|class = MathRel   ; codepoint = 0x2261|);  % â‰¡
    (|class = MathRel   ; codepoint = 0x2262|);  % â‰¢
    (|class = MathRel   ; codepoint = 0x2263|);  % â‰£
    (|class = MathRel   ; codepoint = 0x2264|);  % â‰¤
    (|class = MathRel   ; codepoint = 0x2265|);  % â‰¥
    (|class = MathRel   ; codepoint = 0x2266|);  % â‰¦
    (|class = MathRel   ; codepoint = 0x2267|);  % â‰§
    (|class = MathRel   ; codepoint = 0x2268|);  % â‰¨
    (|class = MathRel   ; codepoint = 0x2269|);  % â‰©
    (|class = MathRel   ; codepoint = 0x226A|);  % â‰ª
    (|class = MathRel   ; codepoint = 0x226B|);  % â‰«
    (|class = MathRel   ; codepoint = 0x226C|);  % â‰¬
    (|class = MathRel   ; codepoint = 0x226D|);  % â‰­
    (|class = MathRel   ; codepoint = 0x226E|);  % â‰®
    (|class = MathRel   ; codepoint = 0x226F|);  % â‰¯
    (|class = MathRel   ; codepoint = 0x2270|);  % â‰°
    (|class = MathRel   ; codepoint = 0x2271|);  % â‰±
    (|class = MathRel   ; codepoint = 0x2272|);  % â‰²
    (|class = MathRel   ; codepoint = 0x2273|);  % â‰³
    (|class = MathRel   ; codepoint = 0x2274|);  % â‰´
    (|class = MathRel   ; codepoint = 0x2275|);  % â‰µ
    (|class = MathRel   ; codepoint = 0x2276|);  % â‰¶
    (|class = MathRel   ; codepoint = 0x2277|);  % â‰·
    (|class = MathRel   ; codepoint = 0x2278|);  % â‰¸
    (|class = MathRel   ; codepoint = 0x2279|);  % â‰¹
    (|class = MathRel   ; codepoint = 0x227A|);  % â‰º
    (|class = MathRel   ; codepoint = 0x227B|);  % â‰»
    (|class = MathRel   ; codepoint = 0x227C|);  % â‰¼
    (|class = MathRel   ; codepoint = 0x227D|);  % â‰½
    (|class = MathRel   ; codepoint = 0x227E|);  % â‰¾
    (|class = MathRel   ; codepoint = 0x227F|);  % â‰¿
    (|class = MathRel   ; codepoint = 0x2280|);  % âŠ€
    (|class = MathRel   ; codepoint = 0x2281|);  % âŠ
    (|class = MathRel   ; codepoint = 0x2282|);  % âŠ‚
    (|class = MathRel   ; codepoint = 0x2283|);  % âŠƒ
    (|class = MathRel   ; codepoint = 0x2284|);  % âŠ„
    (|class = MathRel   ; codepoint = 0x2285|);  % âŠ…
    (|class = MathRel   ; codepoint = 0x2286|);  % âŠ†
    (|class = MathRel   ; codepoint = 0x2287|);  % âŠ‡
    (|class = MathRel   ; codepoint = 0x2288|);  % âŠˆ
    (|class = MathRel   ; codepoint = 0x2289|);  % âŠ‰
    (|class = MathRel   ; codepoint = 0x228A|);  % âŠŠ
    (|class = MathRel   ; codepoint = 0x228B|);  % âŠ‹
    (|class = MathOp    ; codepoint = 0x228C|);  % âŠŒ
    (|class = MathOp    ; codepoint = 0x228D|);  % âŠ
    (|class = MathOp    ; codepoint = 0x228E|);  % âŠŽ
    (|class = MathRel   ; codepoint = 0x228F|);  % âŠ
    (|class = MathRel   ; codepoint = 0x2290|);  % âŠ
    (|class = MathRel   ; codepoint = 0x2291|);  % âŠ‘
    (|class = MathRel   ; codepoint = 0x2292|);  % âŠ’
    (|class = MathOp    ; codepoint = 0x2293|);  % âŠ“
    (|class = MathOp    ; codepoint = 0x2294|);  % âŠ”
    (|class = MathOp    ; codepoint = 0x2295|);  % âŠ•
    (|class = MathOp    ; codepoint = 0x2296|);  % âŠ–
    (|class = MathOp    ; codepoint = 0x2297|);  % âŠ—
    (|class = MathOp    ; codepoint = 0x2298|);  % âŠ˜
    (|class = MathOp    ; codepoint = 0x2299|);  % âŠ™
    (|class = MathOp    ; codepoint = 0x229A|);  % âŠš
    (|class = MathOp    ; codepoint = 0x229B|);  % âŠ›
    (|class = MathOp    ; codepoint = 0x229C|);  % âŠœ
    (|class = MathOp    ; codepoint = 0x229D|);  % âŠ
    (|class = MathOp    ; codepoint = 0x229E|);  % âŠž
    (|class = MathOp    ; codepoint = 0x229F|);  % âŠŸ
    (|class = MathOp    ; codepoint = 0x22A0|);  % âŠ 
    (|class = MathOp    ; codepoint = 0x22A1|);  % âŠ¡
    (|class = MathOp    ; codepoint = 0x22A2|);  % âŠ¢
    (|class = MathOp    ; codepoint = 0x22A3|);  % âŠ£
    (|class = MathOrd   ; codepoint = 0x22A4|);  % âŠ¤
    (|class = MathRel   ; codepoint = 0x22A5|);  % âŠ¥
    (|class = MathRel   ; codepoint = 0x22A6|);  % âŠ¦
    (|class = MathRel   ; codepoint = 0x22A7|);  % âŠ§
    (|class = MathRel   ; codepoint = 0x22A8|);  % âŠ¨
    (|class = MathRel   ; codepoint = 0x22A9|);  % âŠ©
    (|class = MathRel   ; codepoint = 0x22AA|);  % âŠª
    (|class = MathRel   ; codepoint = 0x22AB|);  % âŠ«
    (|class = MathRel   ; codepoint = 0x22AC|);  % âŠ¬
    (|class = MathRel   ; codepoint = 0x22AD|);  % âŠ­
    (|class = MathRel   ; codepoint = 0x22AE|);  % âŠ®
    (|class = MathRel   ; codepoint = 0x22AF|);  % âŠ¯
    (|class = MathRel   ; codepoint = 0x22B0|);  % âŠ°
    (|class = MathRel   ; codepoint = 0x22B1|);  % âŠ±
    (|class = MathRel   ; codepoint = 0x22B2|);  % âŠ²
    (|class = MathRel   ; codepoint = 0x22B3|);  % âŠ³
    (|class = MathRel   ; codepoint = 0x22B4|);  % âŠ´
    (|class = MathRel   ; codepoint = 0x22B5|);  % âŠµ
    (|class = MathRel   ; codepoint = 0x22B6|);  % âŠ¶
    (|class = MathRel   ; codepoint = 0x22B7|);  % âŠ·
    (|class = MathRel   ; codepoint = 0x22B8|);  % âŠ¸
    (|class = MathRel   ; codepoint = 0x22B9|);  % âŠ¹
    (|class = MathBin   ; codepoint = 0x22BA|);  % âŠº
    (|class = MathBin   ; codepoint = 0x22BB|);  % âŠ»
    (|class = MathBin   ; codepoint = 0x22BC|);  % âŠ¼
    (|class = MathBin   ; codepoint = 0x22BD|);  % âŠ½
    (|class = MathOrd   ; codepoint = 0x22BE|);  % âŠ¾
    (|class = MathOrd   ; codepoint = 0x22BF|);  % âŠ¿
    (|class = MathOp    ; codepoint = 0x22C0|);  % â‹€
    (|class = MathOp    ; codepoint = 0x22C1|);  % â‹
    (|class = MathOp    ; codepoint = 0x22C2|);  % â‹‚
    (|class = MathOp    ; codepoint = 0x22C3|);  % â‹ƒ
    (|class = MathBin   ; codepoint = 0x22C4|);  % â‹„
    (|class = MathBin   ; codepoint = 0x22C5|);  % â‹…
    (|class = MathBin   ; codepoint = 0x22C6|);  % â‹†
    (|class = MathBin   ; codepoint = 0x22C7|);  % â‹‡
    (|class = MathRel   ; codepoint = 0x22C8|);  % â‹ˆ
    (|class = MathBin   ; codepoint = 0x22C9|);  % â‹‰
    (|class = MathBin   ; codepoint = 0x22CA|);  % â‹Š
    (|class = MathBin   ; codepoint = 0x22CB|);  % â‹‹
    (|class = MathBin   ; codepoint = 0x22CC|);  % â‹Œ
    (|class = MathRel   ; codepoint = 0x22CD|);  % â‹
    (|class = MathBin   ; codepoint = 0x22CE|);  % â‹Ž
    (|class = MathBin   ; codepoint = 0x22CF|);  % â‹
    (|class = MathRel   ; codepoint = 0x22D0|);  % â‹
    (|class = MathRel   ; codepoint = 0x22D1|);  % â‹‘
    (|class = MathBin   ; codepoint = 0x22D2|);  % â‹’
    (|class = MathBin   ; codepoint = 0x22D3|);  % â‹“
    (|class = MathRel   ; codepoint = 0x22D4|);  % â‹”
    (|class = MathRel   ; codepoint = 0x22D5|);  % â‹•
    (|class = MathRel   ; codepoint = 0x22D6|);  % â‹–
    (|class = MathRel   ; codepoint = 0x22D7|);  % â‹—
    (|class = MathRel   ; codepoint = 0x22D8|);  % â‹˜
    (|class = MathRel   ; codepoint = 0x22D9|);  % â‹™
    (|class = MathRel   ; codepoint = 0x22DA|);  % â‹š
    (|class = MathRel   ; codepoint = 0x22DB|);  % â‹›
    (|class = MathRel   ; codepoint = 0x22DC|);  % â‹œ
    (|class = MathRel   ; codepoint = 0x22DD|);  % â‹
    (|class = MathRel   ; codepoint = 0x22DE|);  % â‹ž
    (|class = MathRel   ; codepoint = 0x22DF|);  % â‹Ÿ
    (|class = MathRel   ; codepoint = 0x22E0|);  % â‹ 
    (|class = MathRel   ; codepoint = 0x22E1|);  % â‹¡
    (|class = MathRel   ; codepoint = 0x22E2|);  % â‹¢
    (|class = MathRel   ; codepoint = 0x22E3|);  % â‹£
    (|class = MathRel   ; codepoint = 0x22E4|);  % â‹¤
    (|class = MathRel   ; codepoint = 0x22E5|);  % â‹¥
    (|class = MathRel   ; codepoint = 0x22E6|);  % â‹¦
    (|class = MathRel   ; codepoint = 0x22E7|);  % â‹§
    (|class = MathRel   ; codepoint = 0x22E8|);  % â‹¨
    (|class = MathRel   ; codepoint = 0x22E9|);  % â‹©
    (|class = MathRel   ; codepoint = 0x22EA|);  % â‹ª
    (|class = MathRel   ; codepoint = 0x22EB|);  % â‹«
    (|class = MathRel   ; codepoint = 0x22EC|);  % â‹¬
    (|class = MathRel   ; codepoint = 0x22ED|);  % â‹­
    (|class = MathOrd   ; codepoint = 0x22EE|);  % â‹®
    (|class = MathOrd   ; codepoint = 0x22EF|);  % â‹¯
    (|class = MathOrd   ; codepoint = 0x22F0|);  % â‹°
    (|class = MathOrd   ; codepoint = 0x22F1|);  % â‹±
    (|class = MathRel   ; codepoint = 0x22F2|);  % â‹²
    (|class = MathRel   ; codepoint = 0x22F3|);  % â‹³
    (|class = MathRel   ; codepoint = 0x22F4|);  % â‹´
    (|class = MathRel   ; codepoint = 0x22F5|);  % â‹µ
    (|class = MathRel   ; codepoint = 0x22F6|);  % â‹¶
    (|class = MathRel   ; codepoint = 0x22F7|);  % â‹·
    (|class = MathRel   ; codepoint = 0x22F8|);  % â‹¸
    (|class = MathRel   ; codepoint = 0x22F9|);  % â‹¹
    (|class = MathRel   ; codepoint = 0x22FA|);  % â‹º
    (|class = MathRel   ; codepoint = 0x22FB|);  % â‹»
    (|class = MathRel   ; codepoint = 0x22FC|);  % â‹¼
    (|class = MathRel   ; codepoint = 0x22FD|);  % â‹½
    (|class = MathRel   ; codepoint = 0x22FE|);  % â‹¾
    (|class = MathRel   ; codepoint = 0x22FF|);  % â‹¿

  ]

  let enable-unicode-math ctx =
    let enable-greek ctx =
      greek-chars |> List.fold-left (fun ctx charinfo -> (
        ctx |> set-math-variant-char MathItalic     charinfo#origin charinfo#normal
            |> set-math-variant-char MathBoldItalic charinfo#origin charinfo#bold
            |> set-math-variant-char MathRoman      charinfo#origin charinfo#normal
            |> set-math-variant-char MathBoldRoman  charinfo#origin charinfo#bold
            |> set-math-variant-char MathScript     charinfo#origin charinfo#normal
            |> set-math-variant-char MathBoldScript charinfo#origin charinfo#bold
      )) ctx
    in
    let enable-unicode-math-char ctx =
      unicode-math-chars |> List.fold-left (fun ctx charinfo -> (
        ctx |> set-math-char charinfo#codepoint charinfo#codepoint charinfo#class
      )) ctx
    in

    ctx |> enable-greek |> enable-unicode-math-char

  let-inline ctx \unicode-math m =
    script-guard Latin (embed-math (enable-unicode-math ctx) m)

  let-block ctx +enable-unicode-math bt = read-block (enable-unicode-math ctx) bt
  let-inline ctx \enable-unicode-math bt = read-inline (enable-unicode-math ctx) bt
end
